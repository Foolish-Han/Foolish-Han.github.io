<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="Foolish-Han"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="canonical" href="https://foolish-han.github.io/2025/03/28/os/lab3实验报告/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><link rel="icon" type="image/png" href="https://foolish-han.oss-cn-beijing.aliyuncs.com/img/01b9dc528c8e555aaa144149fff1a88f_1.jpg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="https://foolish-han.oss-cn-beijing.aliyuncs.com/img/01b9dc528c8e555aaa144149fff1a88f_1.jpg"><meta name="theme-color" content="#00c1d9"><link rel="shortcut icon" href="https://foolish-han.oss-cn-beijing.aliyuncs.com/img/01b9dc528c8e555aaa144149fff1a88f_1.jpg"><title>OS-Lab3 | 人月神话</title><link rel="stylesheet" href="/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/build/tailwind.css"><link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="/fonts/Geist/geist.css"><link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Farsan&display=swap" rel="stylesheet"><script id="hexo-configurations">window.config={hostname:"foolish-han.github.io",root:"/",language:"zh-CN",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!0,link_icon:!0,delete_mask:!1,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!0,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"atom-one-light",dark:"monokai-sublime"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:6,number:!0,expand:!0,init_open:!0},copyright:{enable:!1,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!0,recommendation:{enable:!0,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#00c1d9",secondary:null,default_mode:"dark"},global:{fonts:{chinese:{enable:!0,family:"Noto Sans SC",url:"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},english:{enable:!0,family:"Farsan",url:"https://fonts.googleapis.com/css2?family=Farsan&display=swap"},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!0},scroll_progress:{bar:!0,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!1,custom_message:null},open_graph:{enable:!1,image:"/images/redefine-og.webp",description:"Hexo Theme Redefine, Redefine Your Hexo Journey."},google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"https://foolish-han.oss-cn-beijing.aliyuncs.com/img0/wallhaven-exk2g8.jpg",dark:"https://foolish-han.oss-cn-beijing.aliyuncs.com/img/%E6%88%91%E4%BB%AC%E5%A6%82%E4%BD%95%E5%89%8D%E5%BE%80%E6%9C%88%E7%90%83.png"},title:"人月神话",subtitle:{text:["万里归来颜愈少。微笑，笑时犹带岭梅香。","我见青山多妩媚，料青山见我应如是。","小舟从此逝，江海寄余生。","回首向来萧瑟处，归去，也无风雨也无晴。","醉后不知天在水，满船清梦压星河。"],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#2a272a",dark:"#b1bdc5"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!0,family:"Ma Shan Zheng",url:"https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap"},social_links:{enable:"enable",style:"default",links:{github:"https://github.com/Foolish-Han",instagram:null,zhihu:null,twitter:null,email:null},qrs:null}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"11.4.1"}},version:"2.8.2",navbar:{auto_hide:!0,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Categories:{path:"/categories",icon:"fa-regular fa-folder"},Friends:{icon:"fa-solid fa-link",path:"/links/"},Github:{path:"https://github.com/Foolish-Han",icon:"fa-brands fa-github"}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:"究天人之际，通古今之变",show_on_mobile:!0,links:null,Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Categories:{path:"/categories",icon:"fa-regular fa-folder"}},article_date_format:"auto",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2025/1/1 00:00:00"},window.lang_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},window.data={masonry:!1}</script><link rel="stylesheet" href="/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/fontawesome/brands.min.css"><link rel="stylesheet" href="/fontawesome/solid.min.css"><link rel="stylesheet" href="/fontawesome/regular.min.css"><link rel="stylesheet" href="/fontawesome/sharp-solid.min.css"><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/"><img src="https://foolish-han.oss-cn-beijing.aliyuncs.com/img/01b9dc528c8e555aaa144149fff1a88f_1.jpg" class="w-full h-full rounded-sm"> </a><a class="logo-title" href="/">人月神话</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> 归档</a></li><li class="navbar-item"><a href="/tags"><i class="fa-regular fa-tags fa-fw"></i> 标签</a></li><li class="navbar-item"><a href="/categories"><i class="fa-regular fa-folder fa-fw"></i> 分类</a></li><li class="navbar-item"><a href="/links/"><i class="fa-solid fa-link fa-fw"></i> 友情链接</a></li><li class="navbar-item"><a target="_blank" rel="noopener" href="https://github.com/Foolish-Han"><i class="fa-brands fa-github fa-fw"></i> GITHUB</a></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>首页 </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>归档 </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/tags"><span>标签 </span><i class="fa-regular fa-tags fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/categories"><span>分类 </span><i class="fa-regular fa-folder fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/links/"><span>友情链接 </span><i class="fa-solid fa-link fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" target="_blank" rel="noopener" href="https://github.com/Foolish-Han"><span>GITHUB </span><i class="fa-brands fa-github fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">28</div><div class="label text-third-text-color text-sm">标签</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div><div class="label text-third-text-color text-sm">分类</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div><div class="label text-third-text-color text-sm">文章</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">OS-Lab3</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="https://foolish-han.oss-cn-beijing.aliyuncs.com/img/01b9dc528c8e555aaa144149fff1a88f_1.jpg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">Foolish-Han</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2025-03-28 23:07:28</span> <span class="mobile">2025-03-28 23:07:28</span> <span class="hover-info">创建</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2025-03-28 23:07:28</span> <span class="mobile">2025-03-28 23:07:28</span> <span class="hover-info">更新</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/OS/">OS</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6/">进程调度</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>2.6k 字</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>9 分钟</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><h1>Lab3 实验报告</h1><h2 id="思考题">思考题</h2><h3 id="Thinking-3-1">Thinking 3.1</h3><blockquote><p>请结合 MOS 中的页目录自映射应用解释代码中 e-&gt; env_pgdir [PDX(UVPT)] = PADDR(e-&gt; env_pgdir) | PTE_V 的含义。</p></blockquote><p>UVPT(user virtual page table)：用户页表起始处的内核虚拟地址</p><p>PDX(UVPT)：UVPT 的页目录号</p><p>PADDR(e-&gt; env_pgdir)：用户页目录的内核虚拟地址</p><p>PTE_V：页表项的有效位</p><p>将页目录中第 PDX(UVPT) 项映射到页目录，使得用户可以访问到页目录的内容（只读）。</p><h3 id="Thinking-3-2">Thinking 3.2</h3><blockquote><p>elf_load_seg 以函数指针的形式，接受外部自定义的回调函数 map_page。请你找到与之相关的 data 这一参数在此处的来源，并思考它的作用。没有这个参数可不可以？为什么？</p></blockquote><ul><li><code>data</code> 在 <code>load_icode</code> 函数调用 <code>elf_load_seg</code> 时，以参数 <code>e</code> 的形式传入，即进程页控制块的指针。</li><li>没有这个参数不可以。这个参数在 <code>elf_load_seg</code> 回调 <code>load_icode_mapper</code> 时，需要通过 <code>e-&gt;env_pgdir</code> 和 <code>e-&gt;env_asid</code> 为其指明页目录和命名空间，使得虚拟地址可以正确映射到复制到的物理空间中</li></ul><h3 id="Thinking-3-3">Thinking 3.3</h3><blockquote><p>结合 elf_load_seg 的参数和实现，考虑该函数需要处理哪些页面加载的情况</p></blockquote><ul><li>判断虚拟地址是否页对齐，不对齐，则首先将虚拟地址所在页面的剩余二进制数据填入对应位置中</li><li>接着以页对齐的方式，将剩余的二进制数据填入对应位置中</li><li>倘若其在内存中还有冗余的位置，则为其分配相应的空间</li></ul><h3 id="Thinking-3-4">Thinking 3.4</h3><blockquote><p>思考上面这一段话，并根据自己在 Lab2 中的理解，回答：你认为这里的 env_tf.cp0_epc 存储的是物理地址还是虚拟地址?</p></blockquote><p>虚拟地址。不论是 C 语言，还是汇编语言，其所使用的地址都是虚拟地址。</p><h3 id="Thinking-3-5">Thinking 3.5</h3><blockquote><p>试找出 0、 1、 2、 3 号异常处理函数的具体实现位置。 8 号异常（系统调用）涉及的 do_syscall() 函数将在 Lab4 中实现。</p></blockquote><ul><li>0 号异常处理函数 <code>handle_int</code> 在 <code>genex.S</code> 中实现，lab3 只能处理时钟中断，最终跳转到 <code>sched.c</code> 中的 <code>schedule</code> 实现</li><li>1 号异常处理函数 <code>handle_mod</code> 在 <code>genex.S</code> 中进行分发，跳转到 <code>tlbex.c</code> 中的 <code>do_tlb_mod</code> 函数实现</li><li>2、3 号异常处理函数 <code>handle_tlb</code> 在 <code>genex.S</code> 中进行分发，跳转到 <code>tlbex.c</code> 中的 <code>tlb do_tlb_refill</code> 函数实现</li></ul><h3 id="Thinking-3-6">Thinking 3.6</h3><blockquote><p>阅读 entry.S、 genex.S 和 env_asm.S 这几个文件，并尝试说出时钟中断在哪些时候开启，在哪些时候关闭。</p></blockquote><p>当时钟中断发生后，进入 <code>entry.S</code> 中的 <code>exc_gen_entry</code> 函数进行处理，该函数首先调用 <code>stackframe.h</code> 中的 <code>SAVE_ALL</code> 来保存现场，然后关闭时钟中断，进行异常分发处理。在 <code>genex.S</code> 中通过 <code>handle_int</code> 处理时钟中断，跳转到 <code>sched.c</code> 中的 <code>schedule</code> 实现，在 <code>schedule</code> 最后调用 <code>env_run</code> 时，又调用了 <code>env_run</code> 函数。该函数最后调用了实现在 <code>env_asm.S</code> 中的 <code>env_pop_tf</code> 函数。<code>env_pop_tf</code> 又跳转到 <code>genex.S</code> 中的 <code>ret_from_exception</code> 函数，这个函数调用 <code>stackframe.h</code> 中的 <code>RESTORE_ALL</code> 来恢复现场，重新开启时钟中断。</p><h3 id="Thinking-3-7">Thinking 3.7</h3><blockquote><p>阅读相关代码，思考操作系统是怎么根据时钟中断切换进程的。</p></blockquote><p>类似 3.6，当发生时钟中断后，系统在 <code>sched.c</code> 中通过 <code>schedule</code> 调度进程，当满足一定条件时（详见 [Exercise 3.12](#Exercise 3.12)），则换下一个进程运行（可能仍然是当前进程）。</p><h2 id="难点分析">难点分析</h2><h3 id="Exercise-3-1">Exercise 3.1</h3><h4 id="TAILQ-宏定义分析">TAILQ 宏定义分析</h4><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_TAILQ_HEAD(name, type, qual)</span><br></pre></td></tr></table></figure></div><p>定义一个双向尾队列，这个结构体的名称为 <strong>name</strong>，元素类型为 <strong>type</strong>，里面含有一个指向队列头元素的指针 <strong>tqh_first</strong> 和指向队列尾元素的下一个元素的指针的指针 <strong>tqh_last</strong>，<strong>qual</strong> 为限定符（ quality : const, volatile…）。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_HEAD(name, type)</span><br></pre></td></tr></table></figure></div><p>定义一个双向尾队列，这个结构体的名称为 <strong>name</strong>，元素类型为 <strong>type</strong>，里面含有一个指向队列头元素的指针 <strong>tqh_first</strong> 和指向队列尾元素的下一个元素的指针的指针 <strong>tqh_last</strong>。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_HEAD_INITIALIZER(head) </span><br></pre></td></tr></table></figure></div><p>初始化双向尾队列 <strong>head</strong>（不是指针），将其 <strong>tqh_first</strong> 设置为 <strong>NULL</strong>，将其 <strong>tqh_last</strong> 设置为 <strong>tqh_first</strong> 的地址。给元素赋值时作为常量使用，注意与 <code>TAILQ_INIT(head)</code> 区分。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_TAILQ_ENTRY(type, qual)  </span><br></pre></td></tr></table></figure></div><p>定义双向尾队列元素的指针域，元素类型为 <strong>type</strong>，里面含有一个指向下一个元素地址的指针 <strong>tqe_next</strong>，一个指向前一个元素的下一个元素指针的指针 <strong>tqe_prev</strong>，<strong>qual</strong> 为限定符（ quality : const, volatile…）。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_ENTRY(type)</span><br></pre></td></tr></table></figure></div><p>定义双向尾队列元素的指针域，元素类型为 <strong>type</strong>，里面含有一个指向下一个元素地址的指针 <strong>tqe_next</strong>，一个指向前一个元素的下一个元素指针的指针 <strong>tqe_prev</strong>。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_INIT(head)</span><br></pre></td></tr></table></figure></div><p>初始化指针 <strong>head</strong> 指向的双向尾队列，将其 <strong>tqh_first</strong> 设置为 <strong>NULL</strong>，将其 <strong>tqh_last</strong> 设置为 <strong>tqh_first</strong> 的地址。初始化队列时作为宏函数使用，注意与 <code>TAILQ_HEAD_INITIALIZER(head)</code> 区分。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_INSERT_HEAD(head, elm, field)</span><br></pre></td></tr></table></figure></div><p>在指针 <strong>head</strong> 指向的双向尾队列中，将指针 <strong>elm</strong> 指向的元素插在队列头，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_INSERT_TAIL(head, elm, field)  </span><br></pre></td></tr></table></figure></div><p>在指针 <strong>head</strong> 指向的双向尾队列中，将指针 <strong>elm</strong> 指向的元素插在队列尾，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_INSERT_AFTER(head, listelm, elm, field) </span><br></pre></td></tr></table></figure></div><p>在指针 <strong>head</strong> 指向的双向尾队列中，将指针 <strong>elm</strong> 指向的元素插在指针 <strong>listElm</strong> 指向的元素后面，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_INSERT_BEFORE(listelm, elm, field)</span><br></pre></td></tr></table></figure></div><p>将指针 <strong>elm</strong> 指向的元素插在指针 <strong>listElm</strong> 指向的元素前面，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_REMOVE(head, elm, field)</span><br></pre></td></tr></table></figure></div><p>在指针 <strong>head</strong> 指向的双向尾队列中，将指针 <strong>elm</strong> 指向的元素从中移除，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_FOREACH(var, head, field) </span><br></pre></td></tr></table></figure></div><p>遍历指针 <strong>head</strong> 指向的双向尾队列，<strong>var</strong> 为已声明好的元素指针，供遍历时使用，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_CONCAT(head1, head2, field)</span><br></pre></td></tr></table></figure></div><p>将指针 <strong>head2</strong> 指向的双向尾队列插入到指针 <strong>head1</strong> 指向的双向尾队列后面，并将指针 <strong>head2</strong> 指向的队列清空，<strong>field</strong> 为元素的指针域结构体名称。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_EMPTY(head) ((head)-&gt;tqh_first == <span class="literal">NULL</span>)</span><br></pre></td></tr></table></figure></div><p>判断指针 <strong>head</strong> 指向的双向尾队列是否为空。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_FIRST(head) ((head)-&gt;tqh_first)</span><br></pre></td></tr></table></figure></div><p>获得指针 <strong>head</strong> 指向的双向尾队列的第一个元素的指针。</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TAILQ_NEXT(elm, field) ((elm)-&gt;field.tqe_next)</span><br></pre></td></tr></table></figure></div><p>获得双向尾队列中，<strong>elm</strong> 指向的元素的下一个元素的指针，<strong>field</strong> 为元素的指针域结构体名称。</p><h4 id="注意事项">注意事项</h4><ul><li>初始化空闲进程列表、调度进程列表</li><li>从 <code>envs[NENV-1]</code> 开始倒序将进程控制块插入空闲进程列表中。</li></ul><h3 id="Exercise-3-2">Exercise 3.2</h3><p>利用 <code>page_insert</code> 函数，将从 va<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg></mjx-container>va + i 的虚拟地址映射到 <code>pa</code><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg></mjx-container>pa + i，逐页将物理地址转化为页控制块指针，插入即可。</p><h3 id="Exercise-3-3">Exercise 3.3</h3><p>尝试分配一个页面作为进程的页目录，将页面的引用次数加一，同时设置到进程控制块中。</p><h3 id="Exercise-3-4">Exercise 3.4</h3><ul><li>空闲进程列表为空，则返回错误值；不为空，则取出其中第一个进程控制块</li><li>尝试初始化新进程的地址空间</li><li>为新进程设置父进程的 id，并为自己获取 id，尝试分配命名空间</li><li>从空闲进程列表中移除，赋值到传入指针指定的空间中</li></ul><h3 id="Exercise-3-5">Exercise 3.5</h3><ul><li>尝试分配页</li><li>利用 <code>memcpy</code> 将 src 处开始长度为 len 字节的内容复制到页的起始处（<code>page2kva(p)</code>）加 <code>offset</code> 偏移量的位置上</li></ul><h3 id="Exercise-3-6">Exercise 3.6</h3><p>将进程控制块中 env_tf 的 cp0_epc 设置为 elf 文件的入口地址，使得进程调度时可以从正确的位置开始执行</p><h3 id="Exercise-3-7">Exercise 3.7</h3><ul><li>分配一个进程用于初始化，父进程 id 设置为 0，代表该进程为根节点的进程</li><li>为该进程设置优先级，并将状态设置为可运行</li><li>载入该进程执行所需的二进制数据，并将该进程插入到进程调度列表中</li></ul><h3 id="Exercise-3-8">Exercise 3.8</h3><ul><li>设置进程运行所需的页目录</li><li>调用汇编函数恢复现场，指明该进程的 trapframe 地址和命名空间</li></ul><h3 id="Exercise-3-9">Exercise 3.9</h3><ul><li>从 <code>CP0_CAUSE</code> 中获取异常信息</li><li>取其 <code>6:2</code> 位获得中断码</li><li>根据中断码获取相应中断的处理地址</li><li>跳转到相应位置处理中断</li></ul><h3 id="Exercise-3-10">Exercise 3.10</h3><p>按照要求将 <code>.text.exc_gen_entry</code> 段和 <code>.text.tlb_miss_entry</code> 段 放到相应的地址空间即可</p><h3 id="Exercise-3-11">Exercise 3.11</h3><ul><li>将计数器清零</li><li>将 <code>CP0_COMPARE</code> 设置为预先确定的值</li></ul><h3 id="Exercise-3-12">Exercise 3.12</h3><ul><li>当前进程为空 或 时间片用完 或 当前进程不可运行 或 当前进程主动让出时间片时<ul><li>如果当前进程不为空<ul><li>把它从调度进程列表中移除</li><li>如果当前进程可运行<ul><li>重新添加到调度进程列表的尾部</li></ul></li></ul></li><li>判断调度进程列表是否为空并在为空时发出警告</li><li>从调度进程列表中取出一个新的进程控制块</li><li>设置时间片长度为该进程的优先级</li></ul></li><li>该进程用掉一个时间片，时间片长度减一</li><li>运行该进程</li></ul><h2 id="实验体会">实验体会</h2><p>这次实验和上次实验一样，难点都不在于代码的补全，而在于整个进程调度的流程、中断处理的方式以及各个函数的调用关系的把控。实验代码中有大量令人困惑的缩写、难以理解的操作，尽管不影响补全，但往往既不知其然，也不知其所以然，<s>学了也跟没学一样</s>。指导书也只能提供极为有限的帮助。</p><p>对此，只有顺着 mips_init 的调用逐层去尽可能的理解代码，在各个 C 文件、汇编文件、链接文件之间反复横跳，尽可能地去顿悟（<s>问 AI、看博客、做梦</s>）。毕竟，这次上机也告诉我们，不理解整个体系的代价就是不给提示就做不下去。</p></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6/">#进程调度</a>&nbsp;</li></ul><div class="recommended-article px-2 sm:px-6 md:px-8"><div class="recommended-desktop"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>推荐阅读</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/2025/03/28/OS/Lab2实验报告/" title="OS-Lab2" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="OS-Lab2" class="!max-w-none"> <span class="title">OS-Lab2</span> </a><a class="recommended-article-item" href="/2025/03/28/OS/Shell Challenge 任务文档-韩若愚/" title="OS-Shell Challenge" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="OS-Shell Challenge" class="!max-w-none"> <span class="title">OS-Shell Challenge</span> </a><a class="recommended-article-item" href="/2025/03/28/OS/Lab1实验报告/" title="OS-Lab1" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="OS-Lab1" class="!max-w-none"> <span class="title">OS-Lab1</span></a></div></div><div class="recommended-mobile"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>推荐阅读</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/2025/03/28/OS/Lab2实验报告/" title="OS-Lab2" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="OS-Lab2" class="!max-w-none"> <span class="title">OS-Lab2</span> </a><a class="recommended-article-item" href="/2025/03/28/OS/Shell Challenge 任务文档-韩若愚/" title="OS-Shell Challenge" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="OS-Shell Challenge" class="!max-w-none"> <span class="title">OS-Shell Challenge</span></a></div></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2025/03/28/OS/Lab6%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">OS-Lab6</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2025/03/28/OS/Lab5%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">OS-Lab5</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">目录</div><div class="page-title">OS-Lab3</div><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">Lab3 实验报告</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%9D%E8%80%83%E9%A2%98"><span class="nav-number">1.1.</span> <span class="nav-text">思考题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-1"><span class="nav-number">1.1.1.</span> <span class="nav-text">Thinking 3.1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-2"><span class="nav-number">1.1.2.</span> <span class="nav-text">Thinking 3.2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-3"><span class="nav-number">1.1.3.</span> <span class="nav-text">Thinking 3.3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-4"><span class="nav-number">1.1.4.</span> <span class="nav-text">Thinking 3.4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-5"><span class="nav-number">1.1.5.</span> <span class="nav-text">Thinking 3.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-6"><span class="nav-number">1.1.6.</span> <span class="nav-text">Thinking 3.6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thinking-3-7"><span class="nav-number">1.1.7.</span> <span class="nav-text">Thinking 3.7</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9A%BE%E7%82%B9%E5%88%86%E6%9E%90"><span class="nav-number">1.2.</span> <span class="nav-text">难点分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">Exercise 3.1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TAILQ-%E5%AE%8F%E5%AE%9A%E4%B9%89%E5%88%86%E6%9E%90"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">TAILQ 宏定义分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">注意事项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-2"><span class="nav-number">1.2.2.</span> <span class="nav-text">Exercise 3.2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-3"><span class="nav-number">1.2.3.</span> <span class="nav-text">Exercise 3.3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-4"><span class="nav-number">1.2.4.</span> <span class="nav-text">Exercise 3.4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-5"><span class="nav-number">1.2.5.</span> <span class="nav-text">Exercise 3.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-6"><span class="nav-number">1.2.6.</span> <span class="nav-text">Exercise 3.6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-7"><span class="nav-number">1.2.7.</span> <span class="nav-text">Exercise 3.7</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-8"><span class="nav-number">1.2.8.</span> <span class="nav-text">Exercise 3.8</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-9"><span class="nav-number">1.2.9.</span> <span class="nav-text">Exercise 3.9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-10"><span class="nav-number">1.2.10.</span> <span class="nav-text">Exercise 3.10</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-11"><span class="nav-number">1.2.11.</span> <span class="nav-text">Exercise 3.11</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3-12"><span class="nav-number">1.2.12.</span> <span class="nav-text">Exercise 3.12</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E4%BD%93%E4%BC%9A"><span class="nav-number">1.3.</span> <span class="nav-text">实验体会</span></a></li></ol></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="customize-info my-1">小舟从此逝，江海寄余生。</div><div class="text-center">&copy; <span>2025</span> - 2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">Foolish-Han</a><p class="post-count space-x-0.5"><span>共撰写了 21 篇文章 </span><span>共 54.7k 字</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">访问人数</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">总访问量</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span> <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span></div><div class="icp-info my-1"><a target="_blank" rel="nofollow" href="https://beian.miit.gov.cn">京ICP备2025112106号-1</a></div><div>博客已运行 <span class="odometer" id="runtime_days"></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="/js/build/libs/Swup.min.js"></script><script src="/js/build/libs/SwupSlideTheme.min.js"></script><script src="/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="/js/build/libs/SwupProgressPlugin.min.js"></script><script src="/js/build/libs/SwupScrollPlugin.min.js"></script><script src="/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script src="/js/build/tools/imageViewer.js" type="module"></script><script src="/js/build/utils.js" type="module"></script><script src="/js/build/main.js" type="module"></script><script src="/js/build/layouts/navbarShrink.js" type="module"></script><script src="/js/build/tools/scrollTopBottom.js" type="module"></script><script src="/js/build/tools/lightDarkSwitch.js" type="module"></script><script src="/js/build/layouts/categoryList.js" type="module"></script><script src="/js/build/tools/localSearch.js" type="module"></script><script src="/js/build/tools/codeBlock.js" type="module"></script><script src="/js/build/layouts/lazyload.js" type="module"></script><script src="/js/build/tools/runtime.js"></script><script src="/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="/assets/odometer-theme-minimal.css"><script src="/js/build/libs/Typed.min.js"></script><script src="/js/build/plugins/typed.js" type="module"></script><script src="/js/build/libs/anime.min.js"></script><script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script><script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script><script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script><script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script><script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script><script src="/js/build/libs/pangu.min.js"></script><script src="/js/build/plugins/pangu.js"></script></body></html>